<!DOCTYPE html>

<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   
    <title> Water Station </title>
    <link rel="stylesheet" type="text/css" href="navstyle.css">
    <link rel="icon" type="image/x-icon" href="img/water.png">
    
    <link rel="stylesheet" type="text/css" href="css/bootstrap1.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap4.min.css">
    <!-- Boxicons CDN Link -->
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
     <meta name="viewport" content="width=device-width, initial-scale=1.0">

     <link href="https://fonts.googleapis.com/css2?family=Merienda&display=swap" rel="stylesheet">



    
<link rel='stylesheet' href='https://cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css'>
<link rel='stylesheet' href='https://cdn.datatables.net/buttons/1.2.2/css/buttons.bootstrap.min.css'>

   
    <script src="https://kit.fontawesome.com/dbed6b6114.js" crossorigin="anonymous"></script>

   </head>
<body>






    <div class="sidebar">
            <div class="logo-details">
     
        <div class="logo_name " style=" margin-top: 40px;"> <h3> H2Order </h3><h3>H2Order</h3></div>
      
    </div>
  <br> <br><br><br>
      <ol style="position: relative;
  widows: 100%;
  display: block;">
        <li style="font-size: 1.1em;"><a href="adminhome.html" ><i class="bx bx-grid-alt "></i>dashboard</a></li>
        <li style="font-size: 1.1em;"><a href="Waterstation.html"><i class="bx bxs-droplet"></i>water refilling station</a></li>
        <li style="font-size: 1.1em;"><a href="inspection and monitoring.html"><i class="bx bxs-search-alt-2"></i>inspection and monitoring</a></li>
                <li style="font-size: 1.1em;"><a href="announcement.html" ><i class="bx bxs-megaphone "></i>Announcements</a></li>
                <li style="font-size: 1.1em;" ><a href="#" ><i onclick="logout()" class="bx bx-log-out "></i>Logout</a></li>

      </ol>
    
    </div>
	
  <br><br>
    <div id="banner" style=" margin-left:25%; height: 80px; border-radius: .4rem;
    width: 980px;
    max-height: 3000px;
    max-width: 3000px;
    background-color: #fff;"><br> <h1 style="margin-left: 35px; margin-top: -2px;  font-family: Georgia;">Water Rifilling Station</h1></div>


	
	

      <br>

 <div id="tbl-contain" style=" margin-left:25%; width: 72%;height:100%;  background-color: white;  border-radius: .4rem;">
		
			 <br>
				<div id="container" >
				<table id = "ex-table" class = "table table-striped table-bordered" style="width: 80%; margin-left: 100px;">
					<thead style="background-color: #11101D; border: 3px solid black;color: white">
						<tr style=" border: 3px solid black;" >
							<th style=" border: 3px solid black;">ID</th>
							<th style=" border: 3px solid black;">Name</th>
							<th style=" border: 3px solid black;">Address</th>				
						</tr>
					</thead>
					
					<tbody id="tbody1">
												
					</tbody>
									
				</table>
				</div>
				
		 <br>
</div>


	  



   
<script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-app.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-database.js"></script>
	<script type="module">
		

  
 var config = {
    apiKey: "AIzaSyBPfwe1EXj_CDoGLVSnougb8ntqtJC7dKg",
    authDomain: "h2order-13d55.firebaseapp.com",
    databaseURL: "https://h2order-13d55-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "h2order-13d55",
    storageBucket: "h2order-13d55.appspot.com",
    messagingSenderId: "1074930917295",
    appId: "1:1074930917295:web:c5fcbeb45053ce6355d95a",
    measurementId: "G-3Z6R95RYGC"
  };

  // Initialize Firebase
  firebase.initializeApp(config);
  firebase.analytics();

  

var dataSrc = [];
var count =1;


function loadData(callback){
  var databaseRef = firebase.database().ref("waterstation/");

  //var table = $('#ex-table').DataTable();

  console.log("Loading data starts ...");
  databaseRef.on("child_added", function(data) {
     var storageObj = data.val();
    console.log("Loading data starts3 ...");
      
     var dataSet = [storageObj.Name,storageObj.Name, storageObj.Address];
    

   //table.rows.add([dataSet]).draw(); 
    dataSrc.push(dataSet);
  
    console.log("dataSrc= "+dataSrc);
      
    console.log("Loading data..."+count);
      
    count++;
      
 //  $.holdReady( true );
//$('#ex-table').DataTable().clear().destroy();
  //    
  
console.log("Loading data ends ...");
    
     console.log("table initialization started ...");



 $('#ex-table thead th').each( function () {
        var title = $(this).text();
        $(this).html( title+'<br/><input type="text" placeholder="Search '+title+'" />' );
    } );
 
    // DataTable
    var table = $('#ex-table').DataTable();
 
    // Apply the search
    table.columns().every( function () {
        var that = this;
 
        $( 'input', this.header() ).on( 'keyup change', function () {
            if ( that.search() !== this.value ) {
                that.search( this.value )
                    .draw();
            }
        } );
    } );

        var t =$('#ex-table').DataTable({
          "bDestroy": true,    
          data: dataSrc,


          "columnDefs": [ {
            "searchable": false,

            "orderable": false,
           
            type:'title-string', targets: 0,
        } ],
        "order": [[ 1, 'asc' ]],

       //   data: dataSrc,
          
          dom: 'lfrtipB', buttons: [

          			 {
                          extend: 'colvis',
                          title:  'Records'
                      }, 
                    {
                          extend: 'copyHtml5',
                          title:  'Records'
                      },
                      {
                          extend: 'csvHtml5',
                          title:  'Records'
                      },
                      {
                          extend: 'excelHtml5',
                          title:  'Records'
                      },
                      {
                          extend: 'pdfHtml5',
                          title:  'Records'
                      },
                      'print'
                        ],
                 lengthMenu: [[10, 20, 30, 40,50, -1], [10,20,30,40, 50, "All"]]


          });

      console.log("table initialization ends ...");

    t.on( 'order.dt search.dt', function () {
        t.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
            cell.innerHTML = i+1;
            t.cell(cell).invalidate('dom');
        } );
    } ).draw();
 

  });
  
   if(callback){callback();}
}



function 	downloadObjectAsJson(exportObj, exportName){
  
  var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(exportObj));
    var downloadAnchorNode = document.createElement('a');
    downloadAnchorNode.setAttribute("href",     dataStr);
    downloadAnchorNode.setAttribute("download", exportName + ".json");
//    document.body.appendChild(downloadAnchorNode); // required for firefox
  var container = document.getElementById('container');
container.appendChild(downloadAnchorNode);
//    downloadAnchorNode.click();
//    downloadAnchorNode.remove();
  
}

document.addEventListener("DOMContentLoaded", function(event) {
  var NewFile = "records";
	loadData(downloadObjectAsJson(dataSrc, NewFile));
  
 // loadData(intializeDataTable);
   // var tableData = "["+dataSrc+"]";

  
    });  

	   </script>
	

 
	
   <script src='https:////cdn.datatables.net/plug-ins/1.11.3/sorting/title-string.js'></script>
 <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js'></script>
<script src='https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js'></script>
<script src='https://cdn.datatables.net/buttons/1.2.2/js/dataTables.buttons.min.js'></script>
<script src='https://cdn.datatables.net/buttons/1.2.2/js/buttons.colVis.min.js'></script>
<script src='https://cdn.datatables.net/buttons/1.2.2/js/buttons.html5.min.js'></script>
<script src='https://cdn.datatables.net/buttons/1.2.2/js/buttons.print.min.js'></script>
<script src='https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js'></script>
<script src='https://cdn.datatables.net/buttons/1.2.2/js/buttons.bootstrap.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js'></script>
<script src='https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/vfs_fonts.js'></script>
<script src='https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/pdfmake.min.js'></script>
<!-- The core Firebase JS SDK is always required and must be listed first -->

	
	
<style type="text/css">
	#ex-table_length{
		width:300px;
		height: 2px;
    margin-left: 100px;
	}

  #ex-table_info{
    
    margin-left: 100px;
  }

  .btn-group{

    margin-left: 100px;
  }


	#ex-table_filter{
    float:right;
    margin-right: 100px;
  }
	
	#ex-table_paginate{
    float:right;
    margin-right: 100px;

  
}

 

input{

	color: black;
	font-weight: 400;
}



</style>

	
	

  <script src="js/script.js"></script>

 

</body>
	
	

	





</html>
